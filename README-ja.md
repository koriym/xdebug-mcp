# PHP Xdebug MCP ã‚µãƒ¼ãƒãƒ¼

> AIãŒç§ãŸã¡ã®ã‚ˆã†ã«Xdebugã‚’ä½¿ã£ã¦é–‹ç™º

<img width="256" alt="xdebug-mcp" src="https://koriym.github.io/xdebug-mcp/logo.jpeg" />

PHP Xdebug ã®ãƒ‡ãƒãƒƒã‚°ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æã‚’AIãŒåˆ¶å¾¡ã§ãã‚‹MCPã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚

## æ©Ÿèƒ½

- **42å€‹ã®Xdebugãƒ„ãƒ¼ãƒ«**: ãƒ‡ãƒãƒƒã‚°ã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã®å®Œå…¨è‡ªå‹•åŒ–
- **ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ãƒ‡ãƒãƒƒã‚°**: AIãŒå®Ÿè¡Œæ™‚ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æï¼ˆvar_dumpä¸è¦ï¼‰
- **IDEäº’æ›æ€§**: ãƒãƒ¼ãƒˆ9004ã§PhpStorm/VS Codeï¼ˆ9003ï¼‰ã¨ã®ç«¶åˆã‚’å›é¿
- **ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«**: 6ã¤ã®ç‹¬ç«‹ã—ãŸãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

## ãƒ„ãƒ¼ãƒ«ã‚«ãƒ†ã‚´ãƒª

- **ãƒ‡ãƒãƒƒã‚°**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã€ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œã€å¤‰æ•°æ¤œæŸ»
- **ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã€é–¢æ•°ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€Cachegrindå‡ºåŠ›
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: è¡Œ/é–¢æ•°ã‚«ãƒãƒ¬ãƒƒã‚¸ã€HTML/XMLãƒ¬ãƒãƒ¼ãƒˆã€PHPUnité€£æº
- **æ‹¡å¼µ**: ãƒ¡ãƒ¢ãƒªçµ±è¨ˆã€ã‚¨ãƒ©ãƒ¼åé›†ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€é«˜åº¦ãªãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
composer install
claude mcp add xdebug php "$(pwd)/bin/xdebug-mcp"
./bin/xdebug-profile test/debug_test.php
```

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
composer install
```

**æ¨å¥¨: bin/xdebug-* ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨**
```bash
# æœ€è‰¯ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ - ãƒ„ãƒ¼ãƒ«ãŒXdebugã‚’è‡ªå‹•å‡¦ç†
./bin/xdebug-trace script.php
./bin/xdebug-profile script.php
./bin/xdebug-coverage script.php
```

**æ‰‹å‹•ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼ˆä¸Šè¨˜ã¨åŒç­‰ï¼‰**
```bash
# binã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜ã ãŒæ‰‹å‹•
php -dzend_extension=xdebug -dxdebug.mode=debug -dxdebug.client_port=9004 script.php
```

**php.ini: Xdebugã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰**
```ini
# php.ini ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
;zend_extension=xdebug
# ãã®ä»–ã®Xdebugè¨­å®šã¯bin/xdebug-*ã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•å‡¦ç†ã•ã‚Œã¾ã™
```

### MCPè¨­å®š

```bash
# Claude Desktop
claude mcp add xdebug php "$(pwd)/bin/xdebug-mcp"

# ç¢ºèª
claude mcp list
```

## ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«

- `xdebug-server` - MCPã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆãƒãƒ¼ãƒˆ9004ï¼‰
- `xdebug-mcp` - ã‚³ã‚¢MCPã‚µãƒ¼ãƒãƒ¼ 
- `xdebug-trace` - å®Ÿè¡Œãƒˆãƒ¬ãƒ¼ã‚¹ç”Ÿæˆ
- `xdebug-profile` - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«  
- `xdebug-coverage` - ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æ
- `xdebug-phpunit` - PHPUnité¸æŠçš„Xdebugåˆ†æ

### xdebug-phpunit ä½¿ç”¨æ–¹æ³•

PHPUnitãƒ†ã‚¹ãƒˆã§è‡ªå‹•Xdebugãƒˆãƒ¬ãƒ¼ã‚¹ãƒ»ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œï¼š

```bash
# ç‰¹å®šãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒˆãƒ¬ãƒ¼ã‚¹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰
./bin/xdebug-phpunit tests/UserTest.php::testLogin

# ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
./bin/xdebug-phpunit --profile tests/UserTest.php

# ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã§ã®ãƒˆãƒ¬ãƒ¼ã‚¹
./bin/xdebug-phpunit --filter=testUserAuth

# é…ã„ãƒ†ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
./bin/xdebug-phpunit --profile --filter=testSlow
```

**å‡ºåŠ›:**
- ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ¢ãƒ¼ãƒ‰: `/tmp/trace_*.xt` (å®Ÿè¡Œãƒˆãƒ¬ãƒ¼ã‚¹)
- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ‰: `/tmp/cachegrind.out.*` (ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿)

**è¨­å®šè¦ä»¶:**
`phpunit.xml`ã«è¿½åŠ ï¼š
```xml
<extensions>
    <bootstrap class="Koriym\XdebugMcp\TraceExtension"/>
</extensions>
```

## ä½¿ç”¨ä¾‹

### 1. å®Ÿè¡Œãƒˆãƒ¬ãƒ¼ã‚¹
```bash
claude --print "test/debug_test.phpã‚’å®Ÿè¡Œã—ã¦å®Ÿè¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æã—ã¦"
# AIãŒè‡ªå‹•çš„ã«./bin/xdebug-traceã‚’é¸æŠã—ã¦åˆ†æã‚’æä¾›ï¼š
# âœ… ãƒˆãƒ¬ãƒ¼ã‚¹å®Œäº†: /tmp/xdebug_trace_20250821_044930.xt (64è¡Œ)
# ğŸ“Š åˆ†æ: O(2^n) FibonacciéåŠ¹ç‡æ€§ã€å®‰å®šãƒ¡ãƒ¢ãƒªä½¿ç”¨ã€ãƒã‚¤ã‚¯ãƒ­ç§’ãƒ¬ãƒ™ãƒ«è¨ˆæ¸¬
```

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
```bash
claude --print "test/debug_test.phpã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã—ã¦"
# AIãŒè‡ªå‹•çš„ã«./bin/xdebug-profileã‚’ä½¿ç”¨ï¼š
# âœ… ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å®Œäº†: /tmp/cachegrind.out.1755719364
# ğŸ“Š ã‚µã‚¤ã‚º: 1.9Kã€é–¢æ•°: 29ã€å‘¼ã³å‡ºã—: 28ã€ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š
```

### 3. ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æ
```bash
claude --print "test/debug_test.phpã®ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’åˆ†æã—ã¦"
# AIãŒè‡ªå‹•çš„ã«./bin/xdebug-coverageã‚’ä½¿ç”¨ï¼š
# âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸å®Œäº†: HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
# ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸: 85.2% è¡Œã€92.1% é–¢æ•°ã€æœªãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ç‰¹å®š
```

### 4. ã‚¹ãƒ†ãƒƒãƒ—ãƒ‡ãƒãƒƒã‚°
```bash
claude --print "test/debug_test.phpã‚’ãƒ‡ãƒãƒƒã‚°ã—ã¦ã€15è¡Œç›®ã§breakã—ã¦å¤‰æ•°å€¤ã‚’è¡¨ç¤ºã—ã¦"
# AIãŒãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®šã—ã¦ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æä¾›ï¼š
# âœ… ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆè¨­å®š: test/debug_test.php:15
# ğŸ“Š ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã§ã®å¤‰æ•°å€¤:
# | å¤‰æ•°     | å‹     | å€¤                       |
# |----------|--------|--------------------------|
# | $n       | int    | 6                        |
# | $result  | int    | 8                        |
# | $user    | array  | ['name'=>'John','age'=>30] |
```

### 5. PHPUnitãƒ†ã‚¹ãƒˆ
```bash
# PHPUnitãƒ†ã‚¹ãƒˆã®ãƒ‡ãƒãƒƒã‚°ï¼ˆphpunit.xmlã«TraceExtensionè¿½åŠ å¾Œï¼‰
./bin/xdebug-phpunit tests/Unit/McpServerTest.php::testConnect
```

## åˆ©ç”¨ã§ãã‚‹42ãƒ„ãƒ¼ãƒ«

### Debug (11)
- **xdebug_connect**: Xdebugã‚»ãƒƒã‚·ãƒ§ãƒ³ã«æ¥ç¶š
- **xdebug_disconnect**: Xdebugã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰åˆ‡æ–­
- **xdebug_set_breakpoint**: æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨è¡Œã«ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®š
- **xdebug_remove_breakpoint**: IDã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’å‰Šé™¤
- **xdebug_step_into**: æ¬¡ã®é–¢æ•°å‘¼ã³å‡ºã—ã«ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³
- **xdebug_step_over**: ç¾åœ¨è¡Œã‚’ã‚¹ãƒ†ãƒƒãƒ—ã‚ªãƒ¼ãƒãƒ¼
- **xdebug_step_out**: ç¾åœ¨é–¢æ•°ã‹ã‚‰ã‚¹ãƒ†ãƒƒãƒ—ã‚¢ã‚¦ãƒˆ
- **xdebug_continue**: æ¬¡ã®ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã¾ã§å®Ÿè¡Œç¶™ç¶š
- **xdebug_get_stack**: ç¾åœ¨ã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å–å¾—
- **xdebug_get_variables**: ç¾åœ¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å¤‰æ•°ã‚’å–å¾—
- **xdebug_eval**: ç¾åœ¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§PHPå¼ã‚’è©•ä¾¡

### Profile (4)
- **xdebug_start_profiling**: ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°å®Ÿè¡Œé–‹å§‹
- **xdebug_stop_profiling**: ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°åœæ­¢ã¨çµæœè¿”å´
- **xdebug_get_profile_info**: ç¾åœ¨ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°æƒ…å ±ã‚’å–å¾—
- **xdebug_analyze_profile**: ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æ

### Coverage (6)
- **xdebug_start_coverage**: ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸è¿½è·¡é–‹å§‹
- **xdebug_stop_coverage**: ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸è¿½è·¡åœæ­¢
- **xdebug_get_coverage**: ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- **xdebug_analyze_coverage**: ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- **xdebug_coverage_summary**: ã‚«ãƒãƒ¬ãƒƒã‚¸æ¦‚è¦çµ±è¨ˆã‚’å–å¾—

### Extended (21)
- **xdebug_get_memory_usage**: ç¾åœ¨ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æƒ…å ±ã‚’å–å¾—
- **xdebug_get_peak_memory_usage**: ãƒ”ãƒ¼ã‚¯ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æƒ…å ±ã‚’å–å¾—
- **xdebug_get_stack_depth**: ç¾åœ¨ã®ã‚¹ã‚¿ãƒƒã‚¯æ·±åº¦ãƒ¬ãƒ™ãƒ«ã‚’å–å¾—
- **xdebug_get_time_index**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆé–‹å§‹ã‹ã‚‰ã®æ™‚é–“ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—
- **xdebug_info**: è©³ç´°ãªXdebugè¨­å®šã¨è¨ºæ–­æƒ…å ±ã‚’å–å¾—
- **xdebug_start_error_collection**: PHPã‚¨ãƒ©ãƒ¼ã€é€šçŸ¥ã€è­¦å‘Šã®åé›†é–‹å§‹
- **xdebug_stop_error_collection**: ã‚¨ãƒ©ãƒ¼åé›†åœæ­¢ã¨åé›†ãƒ‡ãƒ¼ã‚¿è¿”å´
- **xdebug_get_collected_errors**: ç¾åœ¨åé›†ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
- **xdebug_start_trace**: é–¢æ•°å‘¼ã³å‡ºã—ãƒˆãƒ¬ãƒ¼ã‚¹é–‹å§‹
- **xdebug_stop_trace**: é–¢æ•°å‘¼ã³å‡ºã—ãƒˆãƒ¬ãƒ¼ã‚¹åœæ­¢ã¨ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿è¿”å´
- **xdebug_get_tracefile_name**: ç¾åœ¨ã®ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
- **xdebug_start_function_monitor**: ç‰¹å®šé–¢æ•°ã®ç›£è¦–é–‹å§‹
- **xdebug_stop_function_monitor**: é–¢æ•°ç›£è¦–åœæ­¢ã¨ç›£è¦–å‘¼ã³å‡ºã—è¿”å´
- **xdebug_list_breakpoints**: ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆä¸€è¦§
- **xdebug_set_exception_breakpoint**: ä¾‹å¤–ã«ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆè¨­å®š
- **xdebug_set_watch_breakpoint**: ã‚¦ã‚©ãƒƒãƒ/æ¡ä»¶ä»˜ããƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆè¨­å®š
- **xdebug_get_function_stack**: å¼•æ•°ã¨å¤‰æ•°ã‚’å«ã‚€è©³ç´°é–¢æ•°ã‚¹ã‚¿ãƒƒã‚¯å–å¾—
- **xdebug_print_function_stack**: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸé–¢æ•°ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹å°åˆ·
- **xdebug_call_info**: å‘¼ã³å‡ºã—ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æƒ…å ±å–å¾—
- **xdebug_get_features**: åˆ©ç”¨å¯èƒ½ãªXdebugæ©Ÿèƒ½ã¨ãã®å€¤ã‚’å…¨å–å¾—
- **xdebug_set_feature**: ç‰¹å®šã®Xdebugæ©Ÿèƒ½å€¤ã‚’è¨­å®š
- **xdebug_get_feature**: ç‰¹å®šã®Xdebugæ©Ÿèƒ½å€¤ã‚’å–å¾—


## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

- `claude mcp list` ã§ç¢ºèª
- Xdebugã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª: `php -m | grep xdebug`
- ãƒãƒ¼ãƒˆç«¶åˆ: xdebug-mcpã¯9004ã€IDEã¯9003ã‚’ä½¿ç”¨

## ãƒªãƒ³ã‚¯

- [Xdebug ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://xdebug.org/docs/)
- [MCPä»•æ§˜](https://modelcontextprotocol.io/)
- [Claude Desktop MCP](https://docs.anthropic.com/claude/docs/mcp)
